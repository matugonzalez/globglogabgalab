---
import { datalist } from "../../content/datalist";

---
<form
    class="p-2 flex justify-center"
>
    <input 
    id="search"
    name="search"
    class="rounded-sm text-lg w-xs bg-amber-100 border-0 outline-none px-1"
    type="search" 
    placeholder="Search some books..."
    list="books"
    />
    <button
        type="submit"
        class=""
    >
        Search
    </button>
    <datalist
        id="books"
    >
        {
            datalist.map((book) => {
                return (
                    <option value={book.slug}>
                        {book.title}
                    </option>
                )
            })
        }
    </datalist>
</form>

<script>
const form = document.querySelector('form');
form?.addEventListener('submit', (e) => {
    e.preventDefault();
    const formData = new FormData(form);
    const searchTerm = formData.get('search')?.toString();

    if (!searchTerm || searchTerm.length === 0) return;

    const url =  new URL("/search", window.location.origin);
    url.searchParams.set('q', searchTerm);
    window.location.assign(url.toString())
})

</script>